# MISTAKE

进行分析

```C
#include <stdio.h>
#include <fcntl.h>

#define PW_LEN 10
#define XORKEY 1

void xor(char* s, int len){
	int i;
	for(i=0; i<len; i++){
		s[i] ^= XORKEY;
	}
}

int main(int argc, char* argv[]){
	
	int fd;
	if(fd=open("/home/mistake/password",O_RDONLY,0400) < 0){ //这个地方 考察 符号优先级 = < 中 < 优先于= 所以  open 一定 大于 0 故 一级 比较  为 False= 0  故 fd = 0
		printf("can't open password %d\n", fd);
		return 0;
	}

	printf("do not bruteforce...\n");
	sleep(time(0)%20);

	char pw_buf[PW_LEN+1];
	int len;
	if(!(len=read(fd,pw_buf,PW_LEN) > 0)){  //fd=0  read函数中 0为 标准读入 故pw_buf 会成为输入点
		printf("read error\n");
		close(fd);
		return 0;		
	}

	char pw_buf2[PW_LEN+1];
	printf("input password : ");
	scanf("%10s", pw_buf2); //输入比较值

	// xor your input
	xor(pw_buf2, 10);// 第一个输入值与1进行异或比较

	if(!strncmp(pw_buf, pw_buf2, PW_LEN)){ //进行值比较
		printf("Password OK\n");
		system("/bin/cat flag\n");
	}
	else{
		printf("Wrong Password\n");
	}

	close(fd);
	return 0;
}
```

故第一次 输入 0000000000   ^1 = 1111111111
  第二次 输入 1111111111  
  方可达到值相同



剩下的补充 符号优先级知识与linux 句柄知识 
  [C语言运算符优先级超详细](https://blog.csdn.net/yuliying/article/details/72898132) 

| **优先级** | **运算符**       | **名称或含义**           | **使用形式**             | **结合方向** | **说明**   |
| ---------- | ---------------- | ------------------------ | ------------------------ | ------------ | ---------- |
| **1**      | **[]**           | 数组下标                 | 数组名[常量表达式]       | 左到右       | --         |
| **()**     | 圆括号           | (表达式）/函数名(形参表) | --                       |              |            |
| **.**      | 成员选择（对象） | 对象.成员名              | --                       |              |            |
| **->**     | 成员选择（指针） | 对象指针->成员名         | --                       |              |            |
|            |                  |                          |                          |              |            |
| **2**      | **-**            | 负号运算符               | -表达式                  | **右到左**   | 单目运算符 |
| **~**      | 按位取反运算符   | ~表达式                  |                          |              |            |
| **++**     | 自增运算符       | ++变量名/变量名++        |                          |              |            |
| **--**     | 自减运算符       | --变量名/变量名--        |                          |              |            |
| *****      | 取值运算符       | *指针变量                |                          |              |            |
| **&**      | 取地址运算符     | &变量名                  |                          |              |            |
| **!**      | 逻辑非运算符     | !表达式                  |                          |              |            |
| **(类型)** | 强制类型转换     | (数据类型)表达式         | --                       |              |            |
| **sizeof** | 长度运算符       | sizeof(表达式)           | --                       |              |            |
|            |                  |                          |                          |              |            |
| **3**      | **/**            | 除                       | 表达式/表达式            | 左到右       | 双目运算符 |
| *****      | 乘               | 表达式*表达式            |                          |              |            |
| **%**      | 余数（取模）     | 整型表达式%整型表达式    |                          |              |            |
| **4**      | **+**            | 加                       | 表达式+表达式            | 左到右       | 双目运算符 |
| **-**      | 减               | 表达式-表达式            |                          |              |            |
| **5**      | **<<**           | 左移                     | 变量<<表达式             | 左到右       | 双目运算符 |
| **>>**     | 右移             | 变量>>表达式             |                          |              |            |
|            |                  |                          |                          |              |            |
| **6**      | **>**            | 大于                     | 表达式>表达式            | 左到右       | 双目运算符 |
| **>=**     | 大于等于         | 表达式>=表达式           |                          |              |            |
| **<**      | 小于             | 表达式<表达式            |                          |              |            |
| **<=**     | 小于等于         | 表达式<=表达式           |                          |              |            |
| **7**      | **==**           | 等于                     | 表达式==表达式           | 左到右       | 双目运算符 |
| **！=**    | 不等于           | 表达式!= 表达式          |                          |              |            |
|            |                  |                          |                          |              |            |
| **8**      | **&**            | 按位与                   | 表达式&表达式            | 左到右       | 双目运算符 |
| **9**      | **^**            | 按位异或                 | 表达式^表达式            | 左到右       | 双目运算符 |
| **10**     | **\|**           | 按位或                   | 表达式\|表达式           | 左到右       | 双目运算符 |
| **11**     | **&&**           | 逻辑与                   | 表达式&&表达式           | 左到右       | 双目运算符 |
| **12**     | **\|\|**         | 逻辑或                   | 表达式\|\|表达式         | 左到右       | 双目运算符 |
|            |                  |                          |                          |              |            |
| **13**     | **?:**           | 条件运算符               | 表达式1?表达式2: 表达式3 | **右到左**   | 三目运算符 |
|            |                  |                          |                          |              |            |
| **14**     | **=**            | 赋值运算符               | 变量=表达式              | **右到左**   | --         |
| **/=**     | 除后赋值         | 变量/=表达式             | --                       |              |            |
| ***=**     | 乘后赋值         | 变量*=表达式             | --                       |              |            |
| **%=**     | 取模后赋值       | 变量%=表达式             | --                       |              |            |
| **+=**     | 加后赋值         | 变量+=表达式             | --                       |              |            |
| **-=**     | 减后赋值         | 变量-=表达式             | --                       |              |            |
| **<<=**    | 左移后赋值       | 变量<<=表达式            | --                       |              |            |
| **>>=**    | 右移后赋值       | 变量>>=表达式            | --                       |              |            |
| **&=**     | 按位与后赋值     | 变量&=表达式             | --                       |              |            |
| **^=**     | 按位异或后赋值   | 变量^=表达式             | --                       |              |            |
| **\|=**    | 按位或后赋值     | 变量\|=表达式            | --                       |              |            |
|            |                  |                          |                          |              |            |
| **15**     | **，**           | 逗号运算符               | 表达式,表达式,…          | 左到右       | --         |



> # linux的文件句柄--fd
>
> 在Linux中，值为0、1、2的fd分别代表标准输入、标准输出和标准错误输出。在程序中打开文件得到的fd从3开始增长。 fd具体是什么呢?在内核中，每一个进程都有一个私有的“打开文件表”，这个表是一个指针数组，每一个元素都指向一个内核的打开文件对象。而fd，就是这 个表的下标。当用户打开一个文件时，内核会在内部生成一个打开文件对象，并在这个表里找到一个空项，让这一项指向生成的打开文件对象，并返回这一项的下标 作为fd。由于这个表处于内核，并且用户无法访问到，因此用户即使拥有fd，也无法得到打开文件对象的地址，只能够通过系统提供的函数来操作。 

